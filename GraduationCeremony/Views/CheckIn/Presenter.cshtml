@model IEnumerable<GraduationCeremony.Models.DB.CheckIn>

@{
    ViewData["Title"] = "Presenter";
}

<h1>Presenter</h1>

<div class="person-profile-container">
    @for (int i = 0; i < Model.Count(); i++)
    {
        <div class="person-profile" style="display: @(i == 0 ? "block" : "none")">
            <div class="person-details">
                <div class="person-name" id="firstName">@Model.ElementAt(i).Forenames </div>
                <div class="person-name" id="lastName">@Model.ElementAt(i).Surname</div>

                <div id="forename"></div>

                <div class="person-award">
                    <div class="award-description">@Model.ElementAt(i).AwardDescription</div>
                    <div class="award-level">@Model.ElementAt(i).Level</div>
                </div>
            </div>
        </div>
    }
</div>

<div class="d-flex justify-content-between">
    <button id="prevButton" class="btn" style="background-color: #ff5733; color: #fff;">Previous Person</button>
    <button id="nextButton" class="btn" style="background-color: #3374ff; color: #fff;">Next Person</button>
</div>

@section scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript">
        var currentPersonIndex = 0;
        var personProfiles = document.querySelectorAll(".person-profile");

        function updateDisplay() {
            for (var i = 0; i < personProfiles.length; i++) {
                if (i === currentPersonIndex) {
                    personProfiles[i].style.display = "block";
                } else {
                    personProfiles[i].style.display = "none";
                }
            }
        }

        function fetchDataAndUpdate() {
            // Use AJAX to fetch the updated data
            $.ajax({
                url: "/Graduation/GetUpdatedPersons",
                type: "GET",
                success: function (data) {
                    // Update the table with new data

                    // Ensure the current index is within bounds
                    currentPersonIndex = Math.min(currentPersonIndex, data.length - 1);

                    updateDisplay();
                }
            });
        }

        // Check for updates (every 5 seconds)
        setInterval(fetchDataAndUpdate, 5000);

        // Event listeners for Next and Previous Buttons
        document.getElementById("nextButton").addEventListener("click", function () {
            if (currentPersonIndex < personProfiles.length - 1) {
                currentPersonIndex++;
                updateDisplay();
            }
        });

        document.getElementById("prevButton").addEventListener("click", function () {
            if (currentPersonIndex > 0) {
                currentPersonIndex--;
                updateDisplay();
            }
        });

        // Initial data fetch and update
        fetchDataAndUpdate();
    </script>
}
</script>



